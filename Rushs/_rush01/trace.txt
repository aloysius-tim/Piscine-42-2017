Working but ERROR if the input map is full and already correct.
